import{d as R,q as f,x as K,o as d,c as p,a as s,b as n,w as l,e as i,K as Y,g as b,F as w,k as x,h as O,i as j,p as z,E as h,r as c,L as G,f as H,D as J,t as u,I as Q,_ as W}from"./index-B7BW4uVQ.js";const X={class:"orders-page"},Z={class:"status-filter"},ee={class:"orders-list"},te={key:1,class:"order-cards"},ae={class:"order-header"},se={class:"restaurant-info"},oe={class:"image-placeholder"},ne={class:"restaurant-details"},le={class:"order-number"},re={class:"order-status"},ie={class:"order-items"},de={class:"item-quantity"},ce={class:"item-name"},ue={class:"item-price"},pe={class:"order-footer"},_e={class:"order-info"},ge={class:"total-amount"},me={class:"order-time"},ve={class:"order-actions"},fe={key:2,class:"pagination"},ye=R({__name:"OrderList",setup(Ce){const D=j(),y=f(!1),C=f([]),v=f(""),o=f({total:0,page:1,limit:10,total_pages:0}),m=async()=>{y.value=!0;try{const t={page:o.value.page,limit:o.value.limit,...v.value&&{status:v.value}},e=await z.get("/api/orders/user",{params:t});C.value=e.orders,o.value={...o.value,total:e.pagination.total,total_pages:e.pagination.total_pages}}catch(t){console.error("Failed to load orders:",t),h.error("Failed to load orders")}finally{y.value=!1}},S=t=>t.charAt(0).toUpperCase()+t.slice(1),V=t=>({pending:"warning",confirmed:"info",preparing:"info",ready:"success",delivering:"success",completed:"success",cancelled:"danger"})[t]||"info",B=t=>new Date(t).toLocaleString(),F=t=>{D.push(`/orders/${t}`)},N=async t=>{var e,r;try{await Q.confirm("Are you sure you want to cancel this order?","Cancel Order",{confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"}),(await z.put(`/api/orders/user/${t}/cancel`)).message==="Order cancelled successfully"&&(h.success("Order cancelled successfully"),m())}catch(_){if(_==="cancel")return;console.error("Failed to cancel order:",_),h.error(((r=(e=_.response)==null?void 0:e.data)==null?void 0:r.message)||"Failed to cancel order")}},$=()=>{o.value.page=1,m()},L=t=>{o.value.limit=t,o.value.page=1,m()},T=t=>{o.value.page=t,m()};return K(()=>{m()}),(t,e)=>{const r=c("el-radio-button"),_=c("el-radio-group"),q=c("el-empty"),E=c("el-icon"),M=c("el-image"),P=c("el-tag"),k=c("el-button"),U=c("el-card"),A=c("el-pagination"),I=G("loading");return d(),p("div",X,[e[13]||(e[13]=s("h1",null,"My Orders",-1)),s("div",Z,[n(_,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=a=>v.value=a),onChange:$},{default:l(()=>[n(r,{label:""},{default:l(()=>e[3]||(e[3]=[i("All")])),_:1}),n(r,{label:"pending"},{default:l(()=>e[4]||(e[4]=[i("Pending")])),_:1}),n(r,{label:"confirmed"},{default:l(()=>e[5]||(e[5]=[i("Confirmed")])),_:1}),n(r,{label:"preparing"},{default:l(()=>e[6]||(e[6]=[i("Preparing")])),_:1}),n(r,{label:"ready"},{default:l(()=>e[7]||(e[7]=[i("Ready")])),_:1}),n(r,{label:"delivering"},{default:l(()=>e[8]||(e[8]=[i("Delivering")])),_:1}),n(r,{label:"completed"},{default:l(()=>e[9]||(e[9]=[i("Completed")])),_:1}),n(r,{label:"cancelled"},{default:l(()=>e[10]||(e[10]=[i("Cancelled")])),_:1})]),_:1},8,["modelValue"])]),Y((d(),p("div",ee,[C.value.length?(d(),p("div",te,[(d(!0),p(w,null,x(C.value,a=>(d(),b(U,{key:a.id,class:"order-card"},{default:l(()=>[s("div",ae,[s("div",se,[n(M,{src:a.restaurant_image,fit:"cover",class:"restaurant-image"},{error:l(()=>[s("div",oe,[n(E,null,{default:l(()=>[n(H(J))]),_:1})])]),_:2},1032,["src"]),s("div",ne,[s("h3",null,u(a.restaurant_name),1),s("p",le,"Order #"+u(a.order_number),1)])]),s("div",re,[n(P,{type:V(a.status)},{default:l(()=>[i(u(S(a.status)),1)]),_:2},1032,["type"])])]),s("div",ie,[(d(!0),p(w,null,x(a.items,g=>(d(),p("div",{key:g.item_name,class:"order-item"},[s("span",de,u(g.quantity)+"x",1),s("span",ce,u(g.item_name),1),s("span",ue,"$"+u(g.subtotal),1)]))),128))]),s("div",pe,[s("div",_e,[s("p",ge,"Total: $"+u(a.total_amount),1),s("p",me,u(B(a.created_at)),1)]),s("div",ve,[n(k,{type:"primary",size:"small",onClick:g=>F(a.id)},{default:l(()=>e[11]||(e[11]=[i(" View Details ")])),_:2},1032,["onClick"]),a.status==="pending"?(d(),b(k,{key:0,type:"danger",size:"small",onClick:g=>N(a.id)},{default:l(()=>e[12]||(e[12]=[i(" Cancel Order ")])),_:2},1032,["onClick"])):O("",!0)])])]),_:2},1024))),128))])):(d(),b(q,{key:0,description:"No orders found"})),o.value.total>o.value.limit?(d(),p("div",fe,[n(A,{"current-page":o.value.page,"onUpdate:currentPage":e[1]||(e[1]=a=>o.value.page=a),"page-size":o.value.limit,"onUpdate:pageSize":e[2]||(e[2]=a=>o.value.limit=a),"page-sizes":[10,20,50],total:o.value.total,layout:"total, sizes, prev, pager, next",onSizeChange:L,onCurrentChange:T},null,8,["current-page","page-size","total"])])):O("",!0)])),[[I,y.value]])])}}}),he=W(ye,[["__scopeId","data-v-bab63967"]]);export{he as default};
