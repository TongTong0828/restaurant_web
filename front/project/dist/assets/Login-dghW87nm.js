import{d as P,u as V,y as x,q as g,J as E,o as U,c as B,a as n,b as t,w as o,f as b,e as v,P as I,i as L,r,Q as R,R as q,E as z,_ as C}from"./index-B7BW4uVQ.js";import{a as N}from"./auth-ueMubseZ.js";const T={class:"login-container"},D={class:"form-footer"},M={class:"auth-links"},A=P({__name:"Login",setup(J){const m=L(),p=V(),c=x(),i=g(),u=g(!1),a=E({email:"",password:""}),w={email:[{required:!0,message:"Please enter your email",trigger:"blur"},{type:"email",message:"Please enter a valid email",trigger:"blur"}],password:[{required:!0,message:"Please enter your password",trigger:"blur"},{min:6,message:"Password must be at least 6 characters",trigger:"blur"}]},y=async()=>{if(i.value)try{await i.value.validate(),u.value=!0;const{token:s,user:e}=await N.login(a);p.setToken(s),p.setUser(e),c.setToken(s),c.setUser(e);const l=localStorage.getItem("redirectPath")||"/";localStorage.removeItem("redirectPath"),e.role==="restaurant"?m.push("/restaurant-admin"):m.push(l)}catch(s){console.error("Login failed:",s),z.error(s.message||"Login failed")}finally{u.value=!1}};return(s,e)=>{const l=r("el-icon"),f=r("el-input"),_=r("el-form-item"),h=r("el-button"),k=r("el-form"),S=r("router-link");return U(),B("div",T,[e[4]||(e[4]=n("h2",null,"Welcome Back",-1)),e[5]||(e[5]=n("p",{class:"subtitle"},"Please sign in to continue",-1)),t(k,{ref_key:"formRef",ref:i,model:a,rules:w,"label-position":"top",onSubmit:I(y,["prevent"])},{default:o(()=>[t(_,{label:"Email",prop:"email"},{default:o(()=>[t(f,{modelValue:a.email,"onUpdate:modelValue":e[0]||(e[0]=d=>a.email=d),placeholder:"Enter your email",type:"email",size:"large"},{prefix:o(()=>[t(l,null,{default:o(()=>[t(b(R))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(_,{label:"Password",prop:"password"},{default:o(()=>[t(f,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=d=>a.password=d),placeholder:"Enter your password",type:"password",size:"large","show-password":""},{prefix:o(()=>[t(l,null,{default:o(()=>[t(b(q))]),_:1})]),_:1},8,["modelValue"])]),_:1}),n("div",D,[t(h,{type:"primary","native-type":"submit",size:"large",loading:u.value,class:"submit-btn"},{default:o(()=>e[2]||(e[2]=[v(" Sign In ")])),_:1},8,["loading"])])]),_:1},8,["model"]),n("div",M,[t(S,{to:"/auth/register"},{default:o(()=>e[3]||(e[3]=[v("Don't have an account? Sign up")])),_:1})])])}}}),j=C(A,[["__scopeId","data-v-2bdc4ceb"]]);export{j as default};
