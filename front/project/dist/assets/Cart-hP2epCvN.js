import{d as D,y as E,q as I,m,x as R,o as u,c as d,a as e,F as O,k as V,t as l,b as c,w as i,e as p,h as $,g as M,i as P,E as T,r as y,_ as z}from"./index-B7BW4uVQ.js";const J={class:"cart-page"},Q={key:0,class:"cart-content"},L={class:"cart-items"},Y={class:"item-info"},j={class:"price"},G={class:"quantity-control"},H={class:"item-total"},K={class:"cart-summary"},U={class:"summary-item"},W={class:"summary-item"},X={class:"summary-item total"},Z={class:"actions"},tt={key:0,class:"minimum-order-warning"},at=D({__name:"Cart",setup(et){const _=P(),S=E(),r=I([]),s=I(null),q=()=>{const a=localStorage.getItem("cart");if(console.log("Raw cart data from localStorage:",a),a)try{const t=JSON.parse(a);if(console.log("Parsed cart data:",t),console.log("Cart validation:",{hasRestaurantId:!!t.restaurantId,hasItems:Array.isArray(t.items),hasRestaurant:!!t.restaurant&&!!t.restaurant.id}),!t.restaurantId||!Array.isArray(t.items))throw console.error("Cart validation failed:",{restaurantId:t.restaurantId,items:t.items,restaurant:t.restaurant}),new Error("Invalid cart data");if(!t.restaurant||!t.restaurant.id||!t.restaurant.name)throw console.error("Invalid restaurant data in cart:",t.restaurant),new Error("Invalid restaurant data");s.value=t.restaurant,r.value=t.items.map(o=>({...o,quantity:parseInt(o.quantity.toString())})),console.log("Successfully loaded cart:",{restaurant:s.value,items:r.value})}catch(t){console.error("Failed to load cart:",t),f()}},g=()=>{if(s.value&&r.value.length>0){const a={restaurantId:s.value.id,restaurant:s.value,items:r.value.map(t=>({id:t.id,name:t.name,price:t.price,description:t.description,image:t.image,category:t.category,quantity:t.quantity}))};localStorage.setItem("cart",JSON.stringify(a)),console.log("Saved cart:",a)}else f()},f=()=>{r.value=[],s.value=null,localStorage.removeItem("cart"),console.log("Cart cleared")},w=a=>{a.quantity++,g()},x=a=>{a.quantity>1?a.quantity--:r.value=r.value.filter(t=>t.id!==a.id),g()},v=m(()=>r.value.reduce((a,t)=>a+t.price*t.quantity,0)),C=m(()=>{var a;return((a=s.value)==null?void 0:a.deliveryFee)||0}),F=m(()=>v.value+C.value),h=m(()=>{var a;return v.value>=(((a=s.value)==null?void 0:a.minimumOrder)||0)}),b=()=>{if(!S.isAuthenticated){T.warning("Please login to continue"),_.push({path:"/auth/login",query:{redirect:"/checkout"}});return}_.push("/checkout")};return R(()=>{q()}),(a,t)=>{var k;const o=y("el-button"),A=y("router-link"),N=y("el-empty");return u(),d("div",J,[t[9]||(t[9]=e("h1",null,"Shopping Cart",-1)),r.value.length>0?(u(),d("div",Q,[e("div",L,[(u(!0),d(O,null,V(r.value,n=>(u(),d("div",{key:n.id,class:"cart-item"},[e("div",Y,[e("h3",null,l(n.name),1),e("p",j,"?"+l(n.price),1)]),e("div",G,[c(o,{type:"primary",circle:"",size:"small",onClick:B=>x(n)},{default:i(()=>t[1]||(t[1]=[p("-")])),_:2},1032,["onClick"]),e("span",null,l(n.quantity),1),c(o,{type:"primary",circle:"",size:"small",onClick:B=>w(n)},{default:i(()=>t[2]||(t[2]=[p("+")])),_:2},1032,["onClick"])]),e("div",H," ?"+l((n.price*n.quantity).toFixed(2)),1)]))),128))]),e("div",K,[e("div",U,[t[3]||(t[3]=e("span",null,"Subtotal:",-1)),e("span",null,"?"+l(v.value.toFixed(2)),1)]),e("div",W,[t[4]||(t[4]=e("span",null,"Delivery Fee:",-1)),e("span",null,"?"+l(C.value.toFixed(2)),1)]),e("div",X,[t[5]||(t[5]=e("span",null,"Total:",-1)),e("span",null,"?"+l(F.value.toFixed(2)),1)]),e("div",Z,[c(o,{onClick:t[0]||(t[0]=n=>a.$router.push("/restaurants"))},{default:i(()=>t[6]||(t[6]=[p(" Continue Shopping ")])),_:1}),c(o,{type:"primary",disabled:!h.value,onClick:b},{default:i(()=>t[7]||(t[7]=[p(" Proceed to Checkout ")])),_:1},8,["disabled"])]),h.value?$("",!0):(u(),d("div",tt," Minimum order amount: ?"+l((k=s.value)==null?void 0:k.minimumOrder),1))])])):(u(),M(N,{key:1,description:"Your cart is empty"},{extra:i(()=>[c(A,{to:"/restaurants"},{default:i(()=>[c(o,{type:"primary"},{default:i(()=>t[8]||(t[8]=[p("Browse Restaurants")])),_:1})]),_:1})]),_:1}))])}}}),st=z(at,[["__scopeId","data-v-a1359106"]]);export{st as default};
