import{d as G,q as V,o as g,c as f,a as i,b as e,w as t,f as p,F as h,k as w,e as P,P as H,i as T,E as b,r as c,Q as $,R as Y,S as Q,B as C,V as X,A as K,W as S,g as Z,t as D,X as ee,U as ae,_ as le}from"./index-B7BW4uVQ.js";const se={class:"register-container"},te=["src"],re={key:1,class:"upload-placeholder"},oe={class:"business-hours"},ne={class:"day-label"},ue={class:"menu-item-header"},ie=["src"],de={key:1,class:"upload-placeholder"},me={class:"form-footer"},pe={class:"auth-links"},ge=G({__name:"Register",setup(ce){T();const U=V(!1),k=V(),R=V(""),I=V(null),O=[{label:"Monday",value:"monday"},{label:"Tuesday",value:"tuesday"},{label:"Wednesday",value:"wednesday"},{label:"Thursday",value:"thursday"},{label:"Friday",value:"friday"},{label:"Saturday",value:"saturday"},{label:"Sunday",value:"sunday"}],B=Object.entries({Japanese:1,Sushi:2,Seafood:3,Italian:4,Pizza:5,Pasta:6,Chinese:7,Asian:8,"Fine Dining":9,Western:10,"Main Dishes":11,Appetizers:12,Rolls:13,Nigiri:14,"Hot Dishes":15,Pizzas:16,Sides:17}).map(([n,a])=>({label:n,value:a})),F=["Appetizers","Main Dishes","Sides","Desserts","Beverages","Pizza","Pasta","Sushi","Rolls","Hot Dishes"],l=V({email:"",password:"",name:"",phone:"",restaurantName:"",description:"",address:"",restaurantPhone:"",delivery_fee:0,minimum_order:0,categories:[],opening_hours:{monday:{open:"",close:""},tuesday:{open:"",close:""},wednesday:{open:"",close:""},thursday:{open:"",close:""},friday:{open:"",close:""},saturday:{open:"",close:""},sunday:{open:"",close:""}},menu_items:[{name:"",description:"",price:0,category:"",imageUrl:"",imageFile:null}]}),q={email:[{required:!0,message:"Please enter email",trigger:"blur"},{type:"email",message:"Please enter a valid email",trigger:"blur"}],password:[{required:!0,message:"Please enter password",trigger:"blur"},{min:6,message:"Password must be at least 6 characters",trigger:"blur"}],name:[{required:!0,message:"Please enter your name",trigger:"blur"}],phone:[{required:!0,message:"Please enter phone number",trigger:"blur"}],restaurantName:[{required:!0,message:"Please enter restaurant name",trigger:"blur"}],address:[{required:!0,message:"Please enter restaurant address",trigger:"blur"}],categories:[{required:!0,message:"Please select at least one category",trigger:"change"}],delivery_fee:[{required:!0,message:"Please enter delivery fee",trigger:"blur"},{type:"number",message:"Delivery fee must be a number",trigger:"blur"}],minimum_order:[{required:!0,message:"Please enter minimum order amount",trigger:"blur"},{type:"number",message:"Minimum order must be a number",trigger:"blur"}]},E=()=>{l.value.menu_items.push({name:"",description:"",price:0,category:"",imageUrl:"",imageFile:null})},x=n=>{l.value.menu_items.splice(n,1)},A=n=>{if(!n)return;const a=n.type.startsWith("image/"),u=n.size/1024/1024<5;if(!a){b.error("You can only upload image files!");return}if(!u){b.error("Image size can not exceed 5MB!");return}I.value=n,R.value=URL.createObjectURL(n)},J=(n,a)=>{if(!n)return;const u=n.type.startsWith("image/"),r=n.size/1024/1024<5;if(!u){b.error("You can only upload image files!");return}if(!r){b.error("Image size can not exceed 5MB!");return}l.value.menu_items[a].imageFile=n,l.value.menu_items[a].imageUrl=URL.createObjectURL(n)},L=async()=>{var n,a,u;if(k.value)try{await k.value.validate(),U.value=!0;const r=new FormData;r.append("email",l.value.email),r.append("password",l.value.password),r.append("name",l.value.name),r.append("phone",l.value.phone),r.append("restaurantName",l.value.restaurantName),r.append("address",l.value.address),l.value.description&&r.append("description",l.value.description),l.value.restaurantPhone&&r.append("restaurantPhone",l.value.restaurantPhone),l.value.categories&&l.value.categories.length>0?r.append("categories",JSON.stringify(l.value.categories)):r.append("categories",JSON.stringify([])),l.value.delivery_fee!==void 0&&r.append("delivery_fee",l.value.delivery_fee.toString()),l.value.minimum_order!==void 0&&r.append("minimum_order",l.value.minimum_order.toString());const o={};Object.entries(l.value.opening_hours).forEach(([v,y])=>{y.open&&y.close&&(o[v]=y)}),Object.keys(o).length>0&&r.append("opening_hours",JSON.stringify(o)),I.value&&r.append("restaurantImage",I.value),console.log("Form Data Contents:");for(let v of r.entries())console.log(v[0]+": "+v[1]);const _=await ae.register(r);console.log("Registration Response:",_),localStorage.setItem("token",_.token),localStorage.setItem("user",JSON.stringify(_.user)),b.success("Registration successful"),window.location.href="/restaurant-admin"}catch(r){console.error("Registration Error Details:",{error:r,response:(n=r.response)==null?void 0:n.data,status:(a=r.response)==null?void 0:a.status,headers:(u=r.response)==null?void 0:u.headers});let o="Registration failed";if(r.response)switch(r.response.data.message){case"Email already exists":o="This email is already registered";break;case"Only image files are allowed!":o="Please upload a valid image file";break;case"File too large":o="Image file must be less than 5MB";break;case"Missing required fields":o="Please fill in all required fields";break;default:o=r.response.data.message||"Registration failed"}b.error(o)}finally{U.value=!1}};return(n,a)=>{const u=c("el-icon"),r=c("el-input"),o=c("el-form-item"),_=c("el-upload"),v=c("el-option"),y=c("el-select"),z=c("el-input-number"),N=c("el-time-select"),M=c("el-button"),j=c("el-form"),W=c("router-link");return g(),f("div",se,[a[24]||(a[24]=i("h2",null,"Restaurant Registration",-1)),a[25]||(a[25]=i("p",{class:"subtitle"},"Register your restaurant to start serving customers",-1)),e(j,{ref_key:"formRef",ref:k,model:l.value,rules:q,"label-position":"top",onSubmit:H(L,["prevent"])},{default:t(()=>[a[19]||(a[19]=i("h3",{class:"section-title"},"Basic Information",-1)),e(o,{label:"Email",prop:"email"},{default:t(()=>[e(r,{modelValue:l.value.email,"onUpdate:modelValue":a[0]||(a[0]=s=>l.value.email=s),placeholder:"Enter business email",type:"email",size:"large"},{prefix:t(()=>[e(u,null,{default:t(()=>[e(p($))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(o,{label:"Password",prop:"password"},{default:t(()=>[e(r,{modelValue:l.value.password,"onUpdate:modelValue":a[1]||(a[1]=s=>l.value.password=s),placeholder:"Create password",type:"password",size:"large","show-password":""},{prefix:t(()=>[e(u,null,{default:t(()=>[e(p(Y))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(o,{label:"Name",prop:"name"},{default:t(()=>[e(r,{modelValue:l.value.name,"onUpdate:modelValue":a[2]||(a[2]=s=>l.value.name=s),placeholder:"Owner's name",size:"large"},{prefix:t(()=>[e(u,null,{default:t(()=>[e(p(Q))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(o,{label:"Phone",prop:"phone"},{default:t(()=>[e(r,{modelValue:l.value.phone,"onUpdate:modelValue":a[3]||(a[3]=s=>l.value.phone=s),placeholder:"Owner's phone",size:"large"},{prefix:t(()=>[e(u,null,{default:t(()=>[e(p(C))]),_:1})]),_:1},8,["modelValue"])]),_:1}),a[20]||(a[20]=i("h3",{class:"section-title"},"Restaurant Information",-1)),e(o,{label:"Restaurant Name",prop:"restaurantName"},{default:t(()=>[e(r,{modelValue:l.value.restaurantName,"onUpdate:modelValue":a[4]||(a[4]=s=>l.value.restaurantName=s),placeholder:"Enter restaurant name",size:"large"},{prefix:t(()=>[e(u,null,{default:t(()=>[e(p(X))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(o,{label:"Description",prop:"description"},{default:t(()=>[e(r,{modelValue:l.value.description,"onUpdate:modelValue":a[5]||(a[5]=s=>l.value.description=s),type:"textarea",placeholder:"Describe your restaurant",rows:3},null,8,["modelValue"])]),_:1}),e(o,{label:"Restaurant Phone",prop:"restaurantPhone"},{default:t(()=>[e(r,{modelValue:l.value.restaurantPhone,"onUpdate:modelValue":a[6]||(a[6]=s=>l.value.restaurantPhone=s),placeholder:"Restaurant phone (optional)",size:"large"},{prefix:t(()=>[e(u,null,{default:t(()=>[e(p(C))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(o,{label:"Address",prop:"address"},{default:t(()=>[e(r,{modelValue:l.value.address,"onUpdate:modelValue":a[7]||(a[7]=s=>l.value.address=s),placeholder:"Enter restaurant address",size:"large"},{prefix:t(()=>[e(u,null,{default:t(()=>[e(p(K))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(o,{label:"Restaurant Image",prop:"restaurantImage"},{default:t(()=>[e(_,{class:"upload-component",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":A,accept:"image/*"},{default:t(()=>[R.value?(g(),f("img",{key:0,src:R.value,class:"preview-image"},null,8,te)):(g(),f("div",re,[e(u,null,{default:t(()=>[e(p(S))]),_:1}),a[11]||(a[11]=i("span",null,"Click to upload restaurant image",-1)),a[12]||(a[12]=i("div",{class:"upload-tip"},"JPG/PNG files less than 5MB",-1))]))]),_:1})]),_:1}),e(o,{label:"Categories",prop:"categories"},{default:t(()=>[e(y,{modelValue:l.value.categories,"onUpdate:modelValue":a[8]||(a[8]=s=>l.value.categories=s),multiple:"",placeholder:"Select restaurant categories",size:"large",style:{width:"100%"}},{default:t(()=>[(g(!0),f(h,null,w(p(B),s=>(g(),Z(v,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(o,{label:"Delivery Fee ($)",prop:"delivery_fee"},{default:t(()=>[e(z,{modelValue:l.value.delivery_fee,"onUpdate:modelValue":a[9]||(a[9]=s=>l.value.delivery_fee=s),precision:2,step:.5,min:0,size:"large",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(o,{label:"Minimum Order ($)",prop:"minimum_order"},{default:t(()=>[e(z,{modelValue:l.value.minimum_order,"onUpdate:modelValue":a[10]||(a[10]=s=>l.value.minimum_order=s),precision:2,step:1,min:0,size:"large",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a[21]||(a[21]=i("h3",{class:"section-title"},"Business Hours",-1)),i("div",oe,[(g(),f(h,null,w(O,s=>i("div",{key:s.value,class:"time-row"},[i("span",ne,D(s.label),1),e(N,{modelValue:l.value.opening_hours[s.value].open,"onUpdate:modelValue":m=>l.value.opening_hours[s.value].open=m,class:"time-select",placeholder:"Opening time",start:"06:00",step:"00:30",end:"24:00"},null,8,["modelValue","onUpdate:modelValue"]),a[13]||(a[13]=i("span",{class:"time-separator"},"to",-1)),e(N,{modelValue:l.value.opening_hours[s.value].close,"onUpdate:modelValue":m=>l.value.opening_hours[s.value].close=m,class:"time-select",placeholder:"Closing time",start:"06:00",step:"00:30",end:"24:00","min-time":l.value.opening_hours[s.value].open},null,8,["modelValue","onUpdate:modelValue","min-time"])])),64))]),a[22]||(a[22]=i("h3",{class:"section-title"},"Menu Items",-1)),(g(!0),f(h,null,w(l.value.menu_items,(s,m)=>(g(),f("div",{key:m,class:"menu-item"},[i("div",ue,[i("h4",null,"Menu Item "+D(m+1),1),e(M,{link:"",type:"danger",onClick:d=>x(m)},{default:t(()=>[e(u,null,{default:t(()=>[e(p(ee))]),_:1}),a[14]||(a[14]=P(" Remove "))]),_:2},1032,["onClick"])]),e(o,{label:"Name",prop:"menu_items."+m+".name"},{default:t(()=>[e(r,{modelValue:s.name,"onUpdate:modelValue":d=>s.name=d,placeholder:"Item name",size:"large"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),e(o,{label:"Description",prop:"menu_items."+m+".description"},{default:t(()=>[e(r,{modelValue:s.description,"onUpdate:modelValue":d=>s.description=d,type:"textarea",placeholder:"Item description",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),e(o,{label:"Price ($)",prop:"menu_items."+m+".price"},{default:t(()=>[e(z,{modelValue:s.price,"onUpdate:modelValue":d=>s.price=d,precision:2,step:.5,min:0,size:"large",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),e(o,{label:"Category",prop:"menu_items."+m+".category"},{default:t(()=>[e(y,{modelValue:s.category,"onUpdate:modelValue":d=>s.category=d,placeholder:"Select category",size:"large",style:{width:"100%"}},{default:t(()=>[(g(),f(h,null,w(F,d=>e(v,{key:d,label:d,value:d},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),e(o,{label:"Image",prop:"menu_items."+m+".image"},{default:t(()=>[e(_,{class:"upload-component",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":d=>J(d,m),accept:"image/*"},{default:t(()=>[s.imageUrl?(g(),f("img",{key:0,src:s.imageUrl,class:"preview-image"},null,8,ie)):(g(),f("div",de,[e(u,null,{default:t(()=>[e(p(S))]),_:1}),a[15]||(a[15]=i("span",null,"Click to upload item image",-1)),a[16]||(a[16]=i("div",{class:"upload-tip"},"JPG/PNG files less than 5MB",-1))]))]),_:2},1032,["on-change"])]),_:2},1032,["prop"])]))),128)),e(M,{type:"primary",plain:"",onClick:E,class:"add-item-btn"},{default:t(()=>[e(u,null,{default:t(()=>[e(p(S))]),_:1}),a[17]||(a[17]=P(" Add Menu Item "))]),_:1}),i("div",me,[e(M,{type:"primary","native-type":"submit",size:"large",loading:U.value,class:"submit-btn"},{default:t(()=>a[18]||(a[18]=[P(" Register Restaurant ")])),_:1},8,["loading"])])]),_:1},8,["model"]),i("div",pe,[e(W,{to:"/restaurant/login"},{default:t(()=>a[23]||(a[23]=[P("Already have an account? Sign in")])),_:1})])])}}}),_e=le(ge,[["__scopeId","data-v-80f62c0c"]]);export{_e as default};
